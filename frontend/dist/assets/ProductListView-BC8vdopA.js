import{i as g,l as U,j as c,c as d,a as e,m as v,v as V,F,e as w,n as y,t as m,_ as L,o as N,d as k,p as A,q as C,f as $,g as O,s as S,x as M,h as B,w as j,k as z}from"./index-Dwbu1JKQ.js";const R={class:"filter-sidebar"},D={class:"mb-3"},E={class:"mb-3"},T=["value","onUpdate:modelValue","id"],G=["for"],I={class:"mb-3"},H=["value","onUpdate:modelValue","id"],J=["for"],K={class:"mb-3"},Q=["value","id"],W=["for"],X={class:"mb-3"},Y={class:"form-label fw-bold"},Z=["max"],ee={class:"mb-3 form-check form-switch"},q={__name:"ProductFilter",props:{metadata:{type:Object,default:()=>({marcas:[],categories:[],sexos:[],maxPrice:1e3})},initialFilters:{type:Object,default:()=>({})}},emits:["filter-change"],setup(p,{emit:_}){const i=p,x=_,o=g({search:i.initialFilters.search||"",marca:i.initialFilters.marca?Array.isArray(i.initialFilters.marca)?i.initialFilters.marca:[i.initialFilters.marca]:[],categoria:i.initialFilters.categoria?Array.isArray(i.initialFilters.categoria)?i.initialFilters.categoria:[i.initialFilters.categoria]:[],sexo:i.initialFilters.sexo?Array.isArray(i.initialFilters.sexo)?i.initialFilters.sexo:[i.initialFilters.sexo]:[],min_price:i.initialFilters.min_price||0,max_price:i.initialFilters.max_price||i.metadata.maxPrice,oferta:i.initialFilters.oferta==="true"||i.initialFilters.oferta===!0});U(o,u=>{x("filter-change",{...u})},{deep:!0});const f=()=>{o.value={search:"",marca:[],categoria:[],sexo:[],min_price:0,max_price:i.metadata.maxPrice,oferta:!1}};return(u,s)=>(c(),d("div",R,[s[9]||(s[9]=e("h5",{class:"mb-3 fw-bold"},"Filtros",-1)),e("div",D,[s[4]||(s[4]=e("label",{class:"form-label"},"Buscar",-1)),v(e("input",{"onUpdate:modelValue":s[0]||(s[0]=a=>o.value.search=a),type:"text",class:"form-control",placeholder:"Nombre..."},null,512),[[V,o.value.search,void 0,{lazy:!0}]])]),e("div",E,[s[5]||(s[5]=e("label",{class:"form-label fw-bold"},"Género",-1)),(c(!0),d(F,null,w(p.metadata.sexos,a=>(c(),d("div",{key:a,class:"form-check"},[v(e("input",{class:"form-check-input",type:"checkbox",value:a,"onUpdate:modelValue":b=>o.value.sexo=b,id:"sexo-"+a},null,8,T),[[y,o.value.sexo]]),e("label",{class:"form-check-label",for:"sexo-"+a},m(a),9,G)]))),128))]),e("div",I,[s[6]||(s[6]=e("label",{class:"form-label fw-bold"},"Marca",-1)),(c(!0),d(F,null,w(p.metadata.marcas,a=>(c(),d("div",{key:a,class:"form-check"},[v(e("input",{class:"form-check-input",type:"checkbox",value:a,"onUpdate:modelValue":b=>o.value.marca=b,id:"marca-"+a},null,8,H),[[y,o.value.marca]]),e("label",{class:"form-check-label",for:"marca-"+a},m(a),9,J)]))),128))]),e("div",K,[s[7]||(s[7]=e("label",{class:"form-label fw-bold"},"Categoría",-1)),(c(!0),d(F,null,w(p.metadata.categorias,a=>(c(),d("div",{key:a,class:"form-check"},[v(e("input",{class:"form-check-input",type:"checkbox",value:a,"onUpdate:modelValue":s[1]||(s[1]=b=>o.value.categoria=b),id:"cat-"+a},null,8,Q),[[y,o.value.categoria]]),e("label",{class:"form-check-label",for:"cat-"+a},m(a),9,W)]))),128))]),e("div",X,[e("label",Y,"Precio Máximo: "+m(o.value.max_price)+" €",1),v(e("input",{type:"range",class:"form-range",min:"0",max:p.metadata.maxPrice,step:"5","onUpdate:modelValue":s[2]||(s[2]=a=>o.value.max_price=a)},null,8,Z),[[V,o.value.max_price,void 0,{number:!0}]])]),e("div",ee,[v(e("input",{class:"form-check-input",type:"checkbox",id:"offerSwitch","onUpdate:modelValue":s[3]||(s[3]=a=>o.value.oferta=a)},null,512),[[y,o.value.oferta]]),s[8]||(s[8]=e("label",{class:"form-check-label",for:"offerSwitch"},"Solo Ofertas",-1))]),e("button",{class:"btn btn-outline-dark w-100",onClick:f},"Limpiar Filtros")]))}},te={class:"container-fluid px-4 px-lg-5 my-5"},ae={class:"row"},se={class:"col-lg-3 col-xl-2 mb-4 d-none d-lg-block"},le={class:"card border-0 shadow-sm mb-4"},ie={class:"card-body"},oe={class:"col-12 d-lg-none mb-3"},re={class:"collapse mt-2",id:"mobileFilters"},ne={class:"card card-body"},ce={class:"col-lg-9 col-xl-10"},de={class:"d-flex justify-content-between align-items-center mb-4"},me={class:"text-muted small"},ue={key:0,class:"text-center py-5"},be={key:1,class:"row"},_e={class:"card h-100 shadow-sm border-0 product-card hover-lift"},fe={class:"card-img-top d-flex align-items-center justify-content-center p-3 position-relative bg-white",style:{height:"250px"}},pe={key:0,class:"badge bg-danger position-absolute top-0 start-0 m-3"},ve=["src","alt"],ge={key:1,class:"text-muted d-flex flex-column align-items-center"},he={class:"card-body d-flex flex-column"},xe={class:"text-muted mb-1 text-uppercase fw-bold",style:{"font-size":"0.75rem"}},ye=["title"],ke={class:"mb-2"},Fe={class:"badge bg-light text-dark border me-1"},we={class:"badge bg-light text-dark border"},$e={class:"mt-auto pt-3 border-top"},Pe={class:"d-flex justify-content-between align-items-center"},Ve={class:"fw-bold fs-5"},Ae={key:0,class:"text-danger text-decoration-line-through"},Ce={key:2,class:"mt-4"},je={class:"pagination justify-content-center"},qe={class:"page-item disabled"},Ue={class:"page-link"},Le={__name:"ProductListView",setup(p){const _=S(),i=M(),x=g([]),o=g({marcas:[],categories:[],sexos:[],maxPrice:1e3}),f=g({}),u=g({}),s=g(!0),a=async(n={})=>{s.value=!0;try{const l={..._.query,...n},r={};for(const h in l)Array.isArray(l[h]),r[h]=l[h];const t=await O.get("/api/products",{params:r});x.value=t.data.data,f.value=t.data.links,u.value=t.data.meta,t.data.additional&&t.data.additional.meta?o.value=t.data.additional.meta:t.data.meta&&!t.data.meta.current_page?o.value=t.data.meta:t.data.meta_data&&(o.value=t.data.meta_data)}catch(l){console.error("Error fetching products:",l)}finally{s.value=!1}};N(()=>{a()}),U(()=>_.query,n=>{a(n)});const b=n=>{const l={};for(const r in n)if(Array.isArray(n[r])&&n[r].length>0)l[r]=n[r];else if(!Array.isArray(n[r])&&n[r]!==""&&n[r]!==0&&n[r]!==!1){if(r==="max_price"&&n[r]===o.value.maxPrice)continue;l[r]=n[r]}i.push({name:"products",query:l})},P=n=>{if(!n)return;const r=new URL(n).searchParams.get("page");i.push({name:"products",query:{..._.query,page:r}})};return(n,l)=>{const r=B("router-link");return c(),d("div",te,[e("div",ae,[e("aside",se,[e("div",le,[e("div",ie,[k(q,{metadata:o.value,"initial-filters":A(_).query,onFilterChange:b},null,8,["metadata","initial-filters"])])])]),e("div",oe,[l[2]||(l[2]=e("button",{class:"btn btn-dark w-100",type:"button","data-bs-toggle":"collapse","data-bs-target":"#mobileFilters"}," Filtros ",-1)),e("div",re,[e("div",ne,[k(q,{metadata:o.value,"initial-filters":A(_).query,onFilterChange:b},null,8,["metadata","initial-filters"])])])]),e("div",ce,[e("div",de,[l[3]||(l[3]=e("h2",{class:"mb-0"},"Productos",-1)),e("span",me,m(u.value.total)+" resultados",1)]),s.value?(c(),d("div",ue,[...l[4]||(l[4]=[e("div",{class:"spinner-border",role:"status"},[e("span",{class:"visually-hidden"},"Loading...")],-1)])])):(c(),d("div",be,[(c(!0),d(F,null,w(x.value,t=>(c(),d("div",{key:t.id,class:"col-12 col-sm-6 col-md-4 col-lg-4 col-xl-3 mb-4"},[e("div",_e,[e("div",fe,[t.oferta?(c(),d("span",pe,"Oferta")):$("",!0),k(r,{to:{name:"product-detail",params:{id:t.id}},class:"d-flex align-items-center justify-content-center h-100 w-100 text-decoration-none"},{default:j(()=>[t.image_url?(c(),d("img",{key:0,src:t.image_url,alt:t.nombre,class:"img-fluid",style:{"max-height":"100%","object-fit":"contain"}},null,8,ve)):(c(),d("div",ge,[...l[5]||(l[5]=[e("i",{class:"bi bi-image fs-1"},null,-1),e("span",null,"Sin imagen",-1)])]))]),_:2},1032,["to"])]),e("div",he,[e("small",xe,m(t.marca),1),e("h5",{class:"card-title text-truncate mb-1",title:t.nombre},[k(r,{to:{name:"product-detail",params:{id:t.id}},class:"text-decoration-none text-dark stretched-link"},{default:j(()=>[z(m(t.nombre),1)]),_:2},1032,["to"])],8,ye),e("div",ke,[e("span",Fe,m(t.sexo),1),e("span",we,m(t.categoria),1)]),e("div",$e,[e("div",Pe,[e("span",Ve,m(Number(t.precio).toFixed(2))+" €",1),t.oferta?(c(),d("small",Ae,m((t.precio*1.2).toFixed(2))+" €",1)):$("",!0)])])])])]))),128))])),u.value.last_page>1?(c(),d("nav",Ce,[e("ul",je,[e("li",{class:C(["page-item",{disabled:!f.value.prev}])},[e("button",{class:"page-link",onClick:l[0]||(l[0]=t=>P(f.value.prev))},"Anterior")],2),e("li",qe,[e("span",Ue,m(u.value.current_page)+" de "+m(u.value.last_page),1)]),e("li",{class:C(["page-item",{disabled:!f.value.next}])},[e("button",{class:"page-link",onClick:l[1]||(l[1]=t=>P(f.value.next))},"Siguiente")],2)])])):$("",!0)])])])}}},Oe=L(Le,[["__scopeId","data-v-a83dd880"]]);export{Oe as default};
